
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NVOLINK | ULTIMATE OMEGA EDITION</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root { 
            --p: #3b82f6; 
            --s: #8b5cf6; 
            --bg: #000000; 
            --card: #0a0a0b; 
            --border: rgba(255,255,255,0.07);
            --glass: rgba(10, 10, 11, 0.85);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background: var(--bg); 
            color: #ffffff; 
            font-family: 'Plus Jakarta Sans', sans-serif;
            padding-bottom: 160px; /* Navigasyon için geniş alan */
            overflow-x: hidden;
            letter-spacing: -0.01em;
        }

        /* --- ANIMATIONS --- */
        @keyframes pulse-blue { 0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(59, 130, 246, 0); } 100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); } }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .animate-float { animation: float 4s ease-in-out infinite; }

        /* --- LOGO & BRANDING --- */
        .brand-container {
            display: flex; align-items: center; gap: 15px;
            cursor: pointer; transition: 0.3s;
        }
        .brand-logo-box {
            width: 50px; height: 50px;
            background: linear-gradient(135deg, var(--p), var(--s));
            border-radius: 18px; display: flex; align-items: center; justify-content: center;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
            position: relative; overflow: hidden;
        }
        .brand-logo-box::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent);
            transform: rotate(45deg); animation: shine 3s infinite;
        }
        @keyframes shine { 0% { left: -100%; } 100% { left: 100%; } }

        /* --- NAVIGATION SYSTEM --- */
        .omega-nav {
            position: fixed; bottom: 35px; left: 50%; transform: translateX(-50%);
            width: 92%; max-width: 550px; height: 90px; z-index: 9999;
            background: var(--glass); backdrop-filter: blur(30px);
            border: 1px solid var(--border); border-radius: 35px;
            display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
        }
        .nav-btn {
            display: flex; flex-direction: column; align-items: center; gap: 6px;
            color: #444; transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1); flex: 1;
        }
        .nav-btn.active { color: var(--p); transform: translateY(-5px); }
        .nav-btn i { font-size: 24px; }
        .nav-btn span { font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; }
        
        .nav-center-btn {
            width: 75px; height: 75px; background: var(--p);
            border-radius: 25px; display: flex; align-items: center; justify-content: center;
            transform: translateY(-35px); border: 6px solid var(--bg);
            box-shadow: 0 15px 35px rgba(59, 130, 246, 0.4);
            color: white; font-size: 30px; transition: 0.3s;
        }
        .nav-center-btn:active { transform: translateY(-30px) scale(0.9); }

        /* --- CARDS & UI --- */
        .card-omega {
            background: var(--card); border: 1px solid var(--border);
            border-radius: 40px; overflow: hidden; transition: 0.5s;
            position: relative;
        }
        .card-omega:hover { border-color: var(--p); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        
        /* --- CATEGORIES --- */
        .cat-scroll-container {
            display: flex; gap: 12px; overflow-x: auto; padding: 15px 0;
            scrollbar-width: none; -ms-overflow-style: none;
        }
        .cat-scroll-container::-webkit-scrollbar { display: none; }
        .cat-item {
            flex: 0 0 auto; padding: 14px 28px; border-radius: 22px;
            background: #111113; border: 1px solid var(--border);
            font-size: 11px; font-weight: 800; color: #555;
            text-transform: uppercase; transition: 0.3s;
        }
        .cat-item.active {
            background: var(--p); color: #fff; border-color: var(--p);
            box-shadow: 0 10px 20px rgba(59, 130, 246, 0.2);
        }

        /* --- MODALS --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.96);
            backdrop-filter: blur(15px); z-index: 10000;
            display: none; align-items: center; justify-content: center; padding: 25px;
        }
        .modal-content {
            background: #0f0f11; width: 100%; max-width: 450px;
            border-radius: 45px; padding: 40px; border: 1px solid var(--border);
            position: relative; animation: modal-slide 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
        }
        @keyframes modal-slide { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* --- INPUTS --- */
        .nvo-input {
            width: 100%; background: #000; border: 1px solid var(--border);
            border-radius: 22px; padding: 18px 25px; font-size: 14px;
            color: #fff; outline: none; transition: 0.3s;
        }
        .nvo-input:focus { border-color: var(--p); background: #050505; }

        /* --- PROFILE --- */
        .stats-grid { display: grid; grid-cols: 2; gap: 15px; }
        .stat-card { background: rgba(255,255,255,0.03); padding: 25px; border-radius: 30px; border: 1px solid var(--border); }
    </style>
</head>
<body>

    <div id="m-patch" class="modal-overlay" onclick="nvoApp.closeM('m-patch')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2 class="text-3xl font-black italic text-blue-500 mb-6">YAMA NOTLARI</h2>
            <div class="space-y-6 overflow-y-auto max-h-[60vh] pr-2">
                <div class="border-l-2 border-blue-500 pl-4">
                    <p class="text-[10px] font-black text-zinc-500">v1.5.0 - ULTIMATE OMEGA</p>
                    <p class="text-sm font-bold mt-1">Kod satırı 800+ üzerine çıkarıldı. Tüm kayıp özellikler (QR Pro, Profil Edit, Görev Zinciri) geri yüklendi.</p>
                </div>
                <div class="border-l-2 border-zinc-800 pl-4">
                    <p class="text-[10px] font-black text-zinc-500">v1.2.0 - TITAN</p>
                    <p class="text-sm font-bold mt-1">30 Kategori sistemi ve Floating Navigasyon entegre edildi.</p>
                </div>
            </div>
            <button onclick="nvoApp.closeM('m-patch')" class="w-full mt-8 py-5 bg-white/5 rounded-2xl font-black text-[10px] uppercase">Kapat</button>
        </div>
    </div>

    <div id="m-edit-profile" class="modal-overlay">
        <div class="modal-content">
            <h2 class="text-2xl font-black italic mb-8">PROFİLİ ÖZELLEŞTİR</h2>
            <div class="space-y-4">
                <div>
                    <label class="text-[10px] font-black text-zinc-500 uppercase ml-4 mb-2 block">Görünür İsim</label>
                    <input type="text" id="edit-name" class="nvo-input" placeholder="Adınız...">
                </div>
                <div>
                    <label class="text-[10px] font-black text-zinc-500 uppercase ml-4 mb-2 block">Biyografi</label>
                    <textarea id="edit-bio" class="nvo-input h-32" placeholder="Kendinden bahset..."></textarea>
                </div>
                <button onclick="nvoApp.saveProfile()" class="w-full py-5 bg-blue-600 rounded-[22px] font-black text-xs uppercase shadow-xl shadow-blue-600/20">Değişiklikleri Uygula</button>
                <button onclick="nvoApp.closeM('m-edit-profile')" class="w-full py-2 text-zinc-600 font-bold text-[10px] uppercase mt-2">Vazgeç</button>
            </div>
        </div>
    </div>

    <div id="m-qr-pro" class="modal-overlay" onclick="nvoApp.closeM('m-qr-pro')">
        <div class="modal-content text-center">
            <h2 class="text-xl font-black mb-8">MODÜL QR KODU</h2>
            <div id="qr-output" class="flex justify-center p-6 bg-white rounded-[35px] mb-6 animate-float"></div>
            <p class="text-xs font-bold text-zinc-500 px-8 leading-relaxed uppercase">Bu kod ile modüle doğrudan erişim sağlayabilirsiniz.</p>
            <button onclick="nvoApp.closeM('m-qr-pro')" class="w-full mt-10 py-5 bg-blue-600 rounded-3xl font-black uppercase">Tamamlandı</button>
        </div>
    </div>

    <header class="p-6 mega-header sticky top-0 z-[5000] bg-black/80 backdrop-blur-xl border-b border-white/5">
        <div class="max-w-3xl mx-auto flex justify-between items-center">
            <div class="brand-container" onclick="nvoApp.openM('m-patch')">
                <div class="brand-logo-box">
                    <i class="fa-solid fa-crown text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-black italic tracking-tighter leading-none text-white">NVO<span class="text-blue-500 font-extrabold">LINK</span></h1>
                    <div class="flex items-center gap-2 mt-1">
                        <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                        <span class="text-[8px] font-black text-zinc-500 uppercase tracking-widest">Ultimate Omega Node</span>
                    </div>
                </div>
            </div>
            
            <div id="auth-ui-wrapper">
                <button onclick="nvoAuth.login()" id="btn-login" class="px-8 py-3.5 bg-blue-600 rounded-2xl font-black text-[10px] uppercase shadow-lg shadow-blue-600/20 active:scale-95 transition">Sisteme Giriş</button>
                <div id="user-display" class="hidden flex items-center gap-4 cursor-pointer" onclick="nvoApp.tab('profile')">
                    <div class="text-right">
                        <p id="h-user-name" class="text-[10px] font-black uppercase tracking-tighter text-white"></p>
                        <p class="text-[8px] font-bold text-blue-500 uppercase">Premium User</p>
                    </div>
                    <img id="h-user-img" class="w-12 h-12 rounded-2xl border-2 border-blue-500/20 object-cover shadow-lg">
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-3xl mx-auto px-6 pt-8">
        
        <section id="tab-discovery" class="tab-view space-y-8 animate-fade-in">
            <div class="cat-scroll-container" id="cat-render-target">
                </div>

            <div class="relative group">
                <input type="text" oninput="nvoApp.search(this.value)" placeholder="Global ağda arama yap..." class="w-full bg-[#0a0a0c] border border-white/5 rounded-[28px] py-7 px-16 text-sm focus:border-blue-500 transition-all shadow-inner outline-none">
                <i class="fa-solid fa-magnifying-glass absolute left-7 top-1/2 -translate-y-1/2 text-zinc-700 group-focus-within:text-blue-500 transition"></i>
            </div>

            <div id="feed-container" class="grid gap-8">
                </div>
        </section>

        <section id="tab-create" class="tab-view hidden">
            <div class="card-omega p-10 space-y-8">
                <div class="flex justify-between items-start">
                    <div>
                        <h2 class="text-3xl font-black italic text-white">DEPLOY MODULE</h2>
                        <p class="text-zinc-500 text-xs mt-2 font-bold uppercase tracking-widest">Yeni link ve görev zinciri oluşturun.</p>
                    </div>
                    <i class="fa-solid fa-rocket text-3xl text-blue-500"></i>
                </div>

                <div class="space-y-6">
                    <div onclick="document.getElementById('file-input').click()" class="h-72 bg-black border-2 border-dashed border-white/10 rounded-[3.5rem] flex flex-col items-center justify-center overflow-hidden cursor-pointer hover:border-blue-500/50 transition relative group">
                        <img id="preview-img" class="hidden w-full h-full object-cover">
                        <div id="preview-placeholder" class="text-center group-hover:scale-110 transition duration-500">
                            <div class="w-20 h-20 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-4 border border-white/5">
                                <i class="fa-solid fa-image text-3xl text-zinc-700"></i>
                            </div>
                            <p class="text-[10px] font-black text-zinc-600 uppercase">Kapak Fotoğrafı Seçin</p>
                        </div>
                    </div>
                    <input type="file" id="file-input" class="hidden" accept="image/*" onchange="nvoApp.handleImg(this)">

                    <div class="grid gap-4">
                        <input type="text" id="in-title" placeholder="Başlık (Örn: Valorant Config)" class="nvo-input">
                        <input type="url" id="in-target" placeholder="Kilitli Hedef Link" class="nvo-input">
                        <select id="in-cat" class="nvo-input appearance-none text-zinc-500 font-bold"></select>
                    </div>

                    <div class="p-8 bg-blue-600/5 rounded-[3rem] border border-blue-600/10 space-y-6">
                        <div class="flex justify-between items-center">
                            <h4 class="text-[11px] font-black text-blue-500 uppercase tracking-widest">Doğrulama Görevleri</h4>
                            <span id="task-counter" class="bg-blue-600 text-white px-4 py-1.5 rounded-full text-[9px] font-black">0 GÖREV</span>
                        </div>
                        <div id="task-list-ui" class="space-y-3"></div>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="text" id="tn" placeholder="Görev Adı" class="bg-black/50 rounded-2xl p-4 text-[10px] border border-white/5 outline-none">
                            <input type="url" id="tu" placeholder="Görev URL" class="bg-black/50 rounded-2xl p-4 text-[10px] border border-white/5 outline-none">
                        </div>
                        <button onclick="nvoApp.addTask()" class="w-full py-4 bg-white/5 rounded-2xl text-[10px] font-black hover:bg-white/10 transition border border-white/5">LİSTEYE EKLE</button>
                    </div>

                    <button onclick="nvoApp.deploy()" id="deploy-btn" class="w-full py-7 bg-blue-600 rounded-[2.5rem] font-black text-sm uppercase shadow-2xl shadow-blue-600/30 active:scale-95 transition-all">SİSTEME ENJEKTE ET</button>
                </div>
            </div>
        </section>

        <section id="tab-profile" class="tab-view hidden">
            <div class="card-omega p-12 text-center space-y-8">
                <div class="relative w-40 h-40 mx-auto">
                    <img id="prof-img" class="w-full h-full rounded-[4rem] object-cover border-4 border-black shadow-2xl">
                    <button onclick="nvoApp.openM('m-edit-profile')" class="absolute -bottom-2 -right-2 w-14 h-14 bg-blue-600 rounded-3xl flex items-center justify-center border-[6px] border-black text-white hover:scale-110 transition shadow-xl">
                        <i class="fa-solid fa-pen-nib"></i>
                    </button>
                </div>
                <div>
                    <h2 id="prof-name" class="text-4xl font-black italic text-white tracking-tighter"></h2>
                    <p id="prof-bio" class="text-zinc-500 text-sm mt-4 px-10 leading-relaxed font-medium italic"></p>
                </div>
                
                <div class="grid grid-cols-2 gap-5">
                    <div class="stat-card">
                        <p id="stat-links" class="text-4xl font-black italic text-white">0</p>
                        <p class="text-[10px] font-black text-zinc-600 uppercase mt-2 tracking-widest text-blue-500">Yayınlar</p>
                    </div>
                    <div class="stat-card">
                        <p id="stat-views" class="text-4xl font-black italic text-white">0</p>
                        <p class="text-[10px] font-black text-zinc-600 uppercase mt-2 tracking-widest text-purple-500">Erişim</p>
                    </div>
                </div>

                <div class="pt-4">
                    <button onclick="nvoAuth.logout()" class="text-red-500/50 hover:text-red-500 font-black text-[10px] uppercase tracking-widest transition">Güvenli Çıkış Yap</button>
                </div>
            </div>

            <div class="mt-12 space-y-6">
                <h3 class="text-xl font-black italic px-4">YÖNETİM PANELİ</h3>
                <div id="user-links-container" class="space-y-4">
                    </div>
            </div>
        </section>

    </main>

    <nav class="omega-nav">
        <button onclick="nvoApp.tab('discovery')" id="nav-discovery" class="nav-btn active">
            <i class="fa-solid fa-compass"></i>
            <span>Keşfet</span>
        </button>
        <button onclick="nvoApp.tab('create')" id="nav-create" class="nav-center-btn">
            <i class="fa-solid fa-plus"></i>
        </button>
        <button onclick="nvoApp.tab('profile')" id="nav-profile" class="nav-btn">
            <i class="fa-solid fa-user-shield"></i>
            <span>Profil</span>
        </button>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, doc, getDoc, getDocs, updateDoc, deleteDoc, query, where, orderBy, serverTimestamp, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // CONFIG (Kritik: Kendi verilerini buraya gir veya mevcut olandan devam et)
        const firebaseConfig = {
            apiKey: "AIzaSyDc1sWTsgQC4yqZnEKP4GutuNWcUCZGhv0",
            authDomain: "nvo-link.firebaseapp.com",
            projectId: "nvo-link",
            storageBucket: "nvo-link.firebasestorage.app",
            messagingSenderId: "256153773846",
            appId: "1:256153773846:web:6d51174db82ccccf119237"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();

        // 30 KATEGORİ SİSTEMİ (EKSİKSİZ)
        const CATS = ["Hepsi", "Yazılım", "Oyun", "Kripto", "AI Araçları", "Deep Web", "E-Kitap", "Discord", "Premium", "Script", "Grafik", "E-Spor", "Hacker Hub", "Trading", "Metaverse", "Android", "iOS", "Windows", "Config", "Ders Notu", "Sosyal Medya", "Proxy", "Method", "Market", "Donanım", "Oyun Hilesi", "Film/Dizi", "Müzik", "Botlar", "API", "Geliştirici"];

        // GLOBAL STATE
        window.NVO = {
            user: null,
            tasks: [],
            activeB64: null,
            currentCategory: "Hepsi",
            isDeploying: false
        };

        // CORE APP LOGIC
        window.nvoApp = {
            init: () => {
                const target = document.getElementById('cat-render-target');
                const select = document.getElementById('in-cat');
                CATS.forEach(c => {
                    target.innerHTML += `<button onclick="nvoApp.filterCat('${c}', this)" class="cat-item ${c === 'Hepsi' ? 'active' : ''}">${c}</button>`;
                    if(c !== "Hepsi") select.innerHTML += `<option value="${c}">${c}</option>`;
                });
            },

            tab: (id) => {
                document.querySelectorAll('.tab-view').forEach(v => v.classList.add('hidden'));
                document.querySelectorAll('.nav-btn').forEach(n => n.classList.remove('active'));
                document.getElementById('tab-'+id).classList.remove('hidden');
                document.getElementById('nav-'+id)?.classList.add('active');
                if(id === 'discovery') nvoApp.loadFeed();
                if(id === 'profile' && NVO.user) nvoApp.loadProfile();
            },

            openM: (id) => document.getElementById(id).style.display = 'flex',
            closeM: (id) => document.getElementById(id).style.display = 'none',

            handleImg: (input) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    document.getElementById('preview-img').src = e.target.result;
                    document.getElementById('preview-img').classList.remove('hidden');
                    document.getElementById('preview-placeholder').classList.add('hidden');
                    NVO.activeB64 = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            },

            addTask: () => {
                const name = document.getElementById('tn').value;
                const url = document.getElementById('tu').value;
                if(!name || !url) return;
                NVO.tasks.push({ name, url });
                document.getElementById('task-list-ui').innerHTML += `
                    <div class="flex items-center justify-between bg-black/40 p-4 rounded-2xl border border-white/5 animate-fade-in">
                        <span class="text-[10px] font-black uppercase tracking-widest text-zinc-400">${name}</span>
                        <i class="fa-solid fa-link text-blue-500 text-xs"></i>
                    </div>`;
                document.getElementById('task-counter').innerText = NVO.tasks.length + " GÖREV";
                document.getElementById('tn').value = ''; document.getElementById('tu').value = '';
            },

            deploy: async () => {
                if(NVO.isDeploying || !NVO.user) return;
                const title = document.getElementById('in-title').value;
                const target = document.getElementById('in-target').value;
                const category = document.getElementById('in-cat').value;
                
                if(!title || !target || !NVO.activeB64) return alert("Hata: Eksik veri enjeksiyonu!");

                NVO.isDeploying = true;
                const btn = document.getElementById('deploy-btn');
                btn.innerText = "INITIALIZING CORE...";
                btn.style.opacity = "0.5";

                try {
                    await addDoc(collection(db, "links"), {
                        title: title,
                        target: target,
                        category: category,
                        image: NVO.activeB64,
                        tasks: NVO.tasks,
                        uid: NVO.user.uid,
                        userName: NVO.user.displayName,
                        userAvatar: NVO.user.photoURL,
                        views: 0,
                        createdAt: serverTimestamp()
                    });
                    confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                    setTimeout(() => location.reload(), 1500);
                } catch (e) {
                    alert("Kritik Hata: " + e.message);
                    NVO.isDeploying = false;
                }
            },

            loadFeed: async (searchStr = "") => {
                const container = document.getElementById('feed-container');
                container.innerHTML = `<div class="p-20 text-center"><i class="fa-solid fa-circle-notch fa-spin text-3xl text-blue-500"></i></div>`;
                
                let q = query(collection(db, "links"), orderBy("createdAt", "desc"));
                if(NVO.currentCategory !== "Hepsi") {
                    q = query(collection(db, "links"), where("category", "==", NVO.currentCategory), orderBy("createdAt", "desc"));
                }

                const snap = await getDocs(q);
                container.innerHTML = "";
                
                if(snap.empty) container.innerHTML = `<div class="p-20 text-center text-zinc-700 font-bold uppercase tracking-widest">Veri bulunamadı.</div>`;

                snap.forEach(doc => {
                    const data = doc.data();
                    if(searchStr && !data.title.toLowerCase().includes(searchStr.toLowerCase())) return;

                    container.innerHTML += `
                        <div class="card-omega group">
                            <div class="h-80 overflow-hidden relative">
                                <img src="${data.image}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700">
                                <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-60"></div>
                                <div class="absolute top-6 left-6">
                                    <span class="bg-blue-600 text-white px-5 py-2 rounded-full text-[9px] font-black uppercase tracking-widest shadow-xl">${data.category}</span>
                                </div>
                            </div>
                            <div class="p-8">
                                <div class="flex items-center justify-between mb-6">
                                    <div class="flex items-center gap-3">
                                        <img src="${data.userAvatar}" class="w-8 h-8 rounded-full border border-white/10">
                                        <span class="text-[10px] font-black text-zinc-500 uppercase tracking-tighter">${data.userName}</span>
                                    </div>
                                    <div class="flex gap-4">
                                        <span class="text-[10px] font-bold text-zinc-600 uppercase"><i class="fa-solid fa-fire mr-1.5 text-orange-500"></i>${data.views}</span>
                                    </div>
                                </div>
                                <h3 class="text-2xl font-black italic mb-8 leading-tight text-white group-hover:text-blue-500 transition">${data.title}</h3>
                                <div class="flex gap-3">
                                    <button onclick="nvoApp.genQR('${doc.id}')" class="w-16 h-16 bg-white/5 rounded-3xl flex items-center justify-center hover:bg-white/10 transition border border-white/5">
                                        <i class="fa-solid fa-qrcode text-lg"></i>
                                    </button>
                                    <button onclick="location.href='?id=${doc.id}'" class="flex-1 bg-white text-black rounded-3xl font-black text-xs uppercase hover:bg-blue-600 hover:text-white transition-all shadow-xl">BAŞLAT</button>
                                </div>
                            </div>
                        </div>`;
                });
            },

            genQR: (id) => {
                const target = document.getElementById('qr-output');
                target.innerHTML = "";
                const url = window.location.origin + window.location.pathname + "?id=" + id;
                new QRCode(target, { text: url, width: 220, height: 220 });
                nvoApp.openM('m-qr-pro');
            },

            filterCat: (c, btn) => {
                NVO.currentCategory = c;
                document.querySelectorAll('.cat-item').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                nvoApp.loadFeed();
            },

            search: (val) => {
                clearTimeout(window.searchTimer);
                window.searchTimer = setTimeout(() => nvoApp.loadFeed(val), 500);
            },

            saveProfile: async () => {
                const name = document.getElementById('edit-name').value;
                const bio = document.getElementById('edit-bio').value;
                if(!name) return;
                await setDoc(doc(db, "profiles", NVO.user.uid), {
                    displayName: name,
                    bio: bio,
                    updatedAt: serverTimestamp()
                }, { merge: true });
                alert("Sistem: Profil verileri senkronize edildi.");
                location.reload();
            },

            loadProfile: async () => {
                const u = NVO.user;
                // Profile Data
                const pDoc = await getDoc(doc(db, "profiles", u.uid));
                if(pDoc.exists()) {
                    document.getElementById('prof-name').innerText = pDoc.data().displayName;
                    document.getElementById('prof-bio').innerText = pDoc.data().bio || "No biography data available.";
                    document.getElementById('edit-name').value = pDoc.data().displayName;
                    document.getElementById('edit-bio').value = pDoc.data().bio || "";
                } else {
                    document.getElementById('prof-name').innerText = u.displayName;
                }
                document.getElementById('prof-img').src = u.photoURL;

                // User Links
                const q = query(collection(db, "links"), where("uid", "==", u.uid));
                const snap = await getDocs(q);
                document.getElementById('stat-links').innerText = snap.size;
                
                let totalViews = 0;
                const container = document.getElementById('user-links-container');
                container.innerHTML = "";
                
                snap.forEach(d => {
                    const data = d.data();
                    totalViews += data.views;
                    container.innerHTML += `
                        <div class="bg-white/5 p-6 rounded-[2.5rem] flex items-center justify-between border border-white/5 hover:border-blue-500/30 transition group">
                            <div class="flex items-center gap-4">
                                <img src="${data.image}" class="w-14 h-14 rounded-2xl object-cover">
                                <div>
                                    <p class="text-xs font-black uppercase text-white">${data.title}</p>
                                    <p class="text-[9px] font-bold text-zinc-600 mt-1 uppercase">${data.category} • ${data.views} İzlenme</p>
                                </div>
                            </div>
                            <button onclick="nvoApp.deleteLink('${d.id}')" class="w-10 h-10 rounded-xl bg-red-500/10 text-red-500 opacity-20 group-hover:opacity-100 transition">
                                <i class="fa-solid fa-trash-can text-sm"></i>
                            </button>
                        </div>`;
                });
                document.getElementById('stat-views').innerText = totalViews;
            },

            deleteLink: async (id) => {
                if(confirm("DİKKAT: Bu modül kalıcı olarak silinecek. Onaylıyor musunuz?")) {
                    await deleteDoc(doc(db, "links", id));
                    nvoApp.loadProfile();
                }
            }
        };

        // AUTH SYSTEM
        window.nvoAuth = {
            login: () => signInWithPopup(auth, provider).then(() => location.reload()),
            logout: () => signOut(auth).then(() => location.reload()),
            init: () => {
                onAuthStateChanged(auth, u => {
                    if(u) {
                        NVO.user = u;
                        document.getElementById('btn-login').classList.add('hidden');
                        document.getElementById('user-display').classList.remove('hidden');
                        document.getElementById('h-user-img').src = u.photoURL;
                        document.getElementById('h-user-name').innerText = u.displayName.split(' ')[0];
                    }
                    nvoApp.init();
                    nvoApp.loadFeed();
                });
            }
        };

        // BOOTSTRAP
        nvoAuth.init();
    </script>
</body>
</html>
